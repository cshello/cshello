
# 2.CyberRT安装.md

## 安装准备基础环境
```txt

1. 安装Ubuntu系统
2. 安装NVIDIA驱动
3. 安装docker
4. 安装nvidia-docker

```

## CyberRT安装
### 1. git克隆源码
```sh

git clone https://github.com/ApolloAuto/apollo --depth=1

```

### 2. 启动docker容器
```sh

# 如果仅使用CyberRT功能
./docker/scripts/cyber_start.sh

# 启动开发容器
./docker/scripts/dev_start.sh

```

### 3. 开启docker容器
```sh

# 如果仅开启CyberRT功能
./docker/scripts/cyber_into.sh

# 开启开发容器
./docker/scripts/dev_into.sh

```


### 4. 在容器中构建CyberRT
```sh

# 构建Apollo
./apollo.sh build

# 仅构建CyberRT
./apollo.sh build cyber

```


### 5. 测试CyberRT
```sh

# 在窗口1中执行talker
source cyber/setup.bash
export GLOG_alsologtostderr=1
./bazel-bin/cyber/examples/talker

# 在窗口2中执行listener
source cyber/setup.bash 
export GLOG_alsologtostderr=1
./bazel-bin/cyber/examples/listener


```


## 使用CyberRT创建并打印HelloWorld
在容器apollo目录直接执行如下C++或Py脚本。
### 编写C++输出HelloWorld
```sh
#!/uar/bin/env bash 

# 写一个简单的例子，一般可以分为4部分
# 1. 编码
# 2. 配置
# 3. 编译
# 4. 执行


echo 当前目录为: $(pwd)

HelloWorld_SRC_DIR="cyber/demo-cc-HelloWorld"
MAIN_BASENAME="HelloWorld"

mkdir -p ${HelloWorld_SRC_DIR}


cat << EOF > ${HelloWorld_SRC_DIR}/${MAIN_BASENAME}.cc

#include "cyber/cyber.h"

int main(int argc, char const *argv[]) {
    apollo::cyber::Init(argv[0]);
    ADEBUG << "Hello World, ADEBUG";
    AINFO << "Hello World, AINFO";
    AWARN << "Hello World, AWARN";
    AERROR << "Hello World, AERROR";
    // AFATAL << "Hello World, AFATAL";    
}

EOF


cat << EOF > ${HelloWorld_SRC_DIR}/BUILD

cc_binary(
    name = "${MAIN_BASENAME}",
    srcs = ["${MAIN_BASENAME}.cc"],
    deps = ["//cyber"]
)

EOF






bazel build ${HelloWorld_SRC_DIR}/${MAIN_BASENAME}

bazel run ${HelloWorld_SRC_DIR}/${MAIN_BASENAME}
```

### 编写Py输出HelloWorld
```sh
#!/usr/bin/env bash 


SRC_DIR="cyber/demo_py_HelloWorld"
MAIN_BASENAME="HelloWorld"

mkdir -p $SRC_DIR

cat << EOF > ${SRC_DIR}/${MAIN_BASENAME}.py

from cyber.python.cyber_py3 import cyber

if __name__ == "__main__":
    cyber.init()
    print("Hello World!")

EOF




cat << EOF > ${SRC_DIR}/BUILD
py_binary(
    name = "${MAIN_BASENAME}",
    srcs = ["${MAIN_BASENAME}.py"],
    deps = ["//cyber/python/cyber_py3:cyber"]
)
EOF


bazel build ${SRC_DIR}:${MAIN_BASENAME}

bazel run ${SRC_DIR}:${MAIN_BASENAME}
```
